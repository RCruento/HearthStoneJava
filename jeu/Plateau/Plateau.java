package jeu.Plateau;

import jeu.Carte.ICarte;
import jeu.Carte.Serviteur;
import jeu.Exception.HearthstoneException;
import jeu.Player.IJoueur;
import java.util.ArrayList;



public class Plateau implements IPlateau {

    private ArrayList<IJoueur> joueurs;
    private boolean debuter = false;
    private IJoueur joueurCourant;

    /**
     * Singleton
     */
    private static Plateau INSTANCE = new Plateau();

    /**
     * Point d'accès pour l'instance unique du singleton
     */
    public static Plateau getInstance() {
        if (INSTANCE == null) {
            new Plateau();
        }
        return INSTANCE;
    }

    private Plateau() {
    }

    //Getter Setter

    public void setPlayers(ArrayList<IJoueur> players) {
        this.joueurs = players;
    }

    @Override
    public void ajouterJoueur(IJoueur joueur) {
        if (this.joueurs == null) {
            this.joueurs = new ArrayList<>();
        }
        this.joueurs.add(joueur);
    }

    @Override
    public void demarerPartie() {
        for (int i = 0; i < 4; i++) {
            this.joueurs.get(0).piocher();
            this.joueurs.get(1).piocher();
        }
        this.getJoueurCourant().piocher();
        System.out.println(this.joueurCourant.getHeros() + " Commence");
        this.debuter = true;
    }

    @Override
    public boolean estDemaree() {
        return this.debuter;
    }

    @Override
    public void gagnerPartie(IJoueur joueur) {
        if (getAdversaire(getJoueurCourant()).getHeros().mort()) {
            this.debuter = false;
            System.out.println("Player : " + joueur.getPseudo() + " a gagné la partie");
            System.exit(0);
        }
    }

    @Override
    public void finirTour(IJoueur joueur) throws HearthstoneException {

        if (!this.getAdversaire(this.getJoueurCourant()).getHeros().mort()) {
            this.joueurCourant.finirTour();
            this.setJoueurCourant(getAdversaire(this.joueurCourant));
            this.getJoueurCourant().piocher();
        } else {
            this.gagnerPartie(joueur);
        }


    }

    @Override
    public IJoueur getAdversaire(IJoueur courantplayer) {
        if (courantplayer == null) {
            throw new IllegalArgumentException("Aucun adveraire");
        }
        if (courantplayer.getPseudo().equals(this.joueurs.get(0).getPseudo())) {
            return this.joueurs.get(1);
        }
        if (courantplayer.getPseudo().equals(this.joueurs.get(1).getPseudo())) {
            return this.joueurs.get(0);
        }
        return courantplayer;
    }

    @Override
    public IJoueur getJoueurCourant() {
        return this.joueurCourant;
    }

    @Override
    public void setJoueurCourant(IJoueur joueur) {
        this.joueurCourant = joueur;
    }


    public String toString() {
        if (this.getJoueurCourant().getJeu().size() == 0 && this.getAdversaire(this.getJoueurCourant()).getJeu().size() == 0) {
            return
                    "Adversaire : " + this.getAdversaire(this.joueurCourant).getPseudo() + "  " + this.getAdversaire(this.joueurCourant).getHeros() + "\n" +
                            "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + "                                                                |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + "                                                         |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            this.joueurCourant.toString();
        } else if (this.getJoueurCourant().getJeu().size() != 0 && this.getAdversaire(this.getJoueurCourant()).getJeu().size() == 0) {
            return
                    "Adversaire : " + this.getAdversaire(this.joueurCourant).getPseudo() + "  " + this.getAdversaire(this.joueurCourant).getHeros() + "\n" +
                            "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + "                                                                |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + this.getJoueurCourant().afficherJeu() + "                                                         |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            this.joueurCourant.toString();

        } else if (this.getJoueurCourant().getJeu().size() == 0 && this.getAdversaire(this.getJoueurCourant()).getJeu().size() != 0) {
            return
                    "Adversaire : " + this.getAdversaire(this.joueurCourant).getPseudo() + "  " + this.getAdversaire(this.joueurCourant).getHeros() + "\n" +
                            "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + this.getAdversaire(this.getJoueurCourant()).afficherJeu() + "                                                                |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|" + "                                                         |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "|                                                                                                                                                                                                                                                                                                                    |\n" +
                            "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                            this.joueurCourant.toString();

        }
        return
                "Adversaire : " + this.getAdversaire(this.joueurCourant).getPseudo() + "  " + this.getAdversaire(this.joueurCourant).getHeros() + "\n" +
                        "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|" + this.getAdversaire(this.getJoueurCourant()).afficherJeu() + "                                                                |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                        "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                        "|" + "--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|" + this.getJoueurCourant().afficherJeu() + "                                                         |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "|                                                                                                                                                                                                                                                                                                                    |\n" +
                        "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n" +
                        this.joueurCourant.toString();


    }
}